# GarminSettingsFileParser

A script to read/write GARMIN.SET settings files from the command line.

These are the settings files used by the Garmin GPS devices and
are stored under `GARMIN/APPS/SETTINGS/APPNAME.SET`

# Description

Reads and writes Garmin settings files that contain configurable properties.

* When calling the program without arguments, it will show this help message.
* When calling the program with one positional argument that points to either
  a GARMIN.SET binary file or a garmin settings JSON file as generated by the
  simulator, it will show information about the file.
* When calling the program with the '--property-id' and '--property-value'
  parameters it will modify the input file value of the property-id with the
  provided value, and write the result to the output file. If no output file
  is provided, the modified properties are printed in stdout (dry-run).

You can only modify one property at a time - if you want to modify multiple
properties, you need to call the program multiple times and use the output file
of one call to the input file of the next call.


# GARMIN.SET format

 1. The file starts with the fixed value 0xABCDABCD,
 2. followed by a 32 bits uint (4 bytes  - big endian) that contains the size of the
    string table that follows.
 3. Each string in the string table starts with a 16 bit uint (2 bytes - big endian)
    that contains the size of each null-terminated string in the string. The null
    terminator is counted in the size of each string.
 4. The string table contains the property IDs, that are themselves strings, as well
    as any other string values that are used in the file.
 5. After the string table, the fix value 0xDA7ADA7A is following,
 6. followed by a 32 bits uint (4 bytes - big endian) with the length of the remaining
    bytes until the end of file (EOF).
 7. The fixed value 0xB0 follows,
 8. followed by a 32 bits uint (4 bytes - big endian) that indicates the number of
    properties that follow. Note that the number of strings in the string table
    must have at least as many strings as the number of properties that are indicated
    by this field. These strings are the property IDs.
 9. The property definitions follow right after. Each property contains two fields:
    A) A string field that points to the corresponding property ID in the string table
    B) A property type identifier that indicates what is the value type of the property
       for the corresponding property ID.

10. Each field is structured as follows:
    a. 8 bits (1 byte) that designates the property type and indicates how the
       the property value is interpreted (see below).
    b. X bytes, big endian, depending on the field type (from a. above), that contain
       the value of the property. If the field type is a string, the value is a
       32 bit uint (4 bytes - big endian) that points to the index of the string
       in the string table. See the table below for the description of the property
       types and how the property values are encoded.

Property type IDs:
```
* 0x01 - number 4 bytes: decoded as int32
* 0x02 -  float 4 bytes: decoded as float
* 0x03 - string 4 bytes: decoded as uint32 value that points to the index of the
                           corresponding string in the string table
* 0x0E -   long 8 bytes: decoded as int64
* 0x09 - boolean 1 byte: decoded as boolean
* 0x0F -  float 8 bytes: decoded as double
```
```
